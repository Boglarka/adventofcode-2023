<?php

$input = ".....................................................................................#......#...............................................
..#.....#.................................................................#........................#........................................
...............................#...............................................................................#.....#......................
.................................................#.............#...............................#...................................#........
..............#......#.................#...............#............#.............#..........................................#..............
.........................................................................................#.................#...............................#
.#..........................................................................................................................................
..........................#......#............................................#......#.................................#....................
.................................................................................................#..........................................
.........................................#..........#..........#............................................................#...............
......#.....#......#..........................#........................#....................................................................
....................................#.........................................................................#..........................#..
..................................................................................#.........................................................
...................................................................................................................#........................
.................................................................#........................................#.................................
.............................#..............................#..........................#.......#............................................
..........................................#.....#.............................#.............................................................
#..................#..................................................................................................................#.....
....................................#...................#..........................#...........................#..............#.............
........#................#...................#.............................................................................................#
...............................#....................#...........................................#...........................................
.......................................#..............................................#.....................................................
........................................................................#........#...........................#..............................
..................................#........#...................#........................................#.........#.................#.......
#................#........................................................................................................#.................
.........#.......................................#...............................................#.............................#........#...
...............................................................................................................#............................
.........................................................................................#..................................................
...........................................................#..................................#..........#...........................#......
......#.........................#..........................................................................................#................
....................#.....................#.......#...............................#.................................#.......................
..........................#..............................................#..................................................................
..........#..........................#.......................#...................................#..............#..............#...........#
......................................................#.....................................................................................
............................................................................................................................................
#...............................................#................#............................#.............................................
..................#......................#............................#................................#................................#...
............................................................................................................................................
....................................................#....................................#.............................#....................
..............#...................#................................#..........#..............................#.............................#
............................#...............................................................................................#...............
....#.................#.....................................#..........#............................................................#.......
......................................................#.....................................................................................
...........#..............................#.................................................#..........#.................#..................
.................................#..............#................#..........#.......#.......................................................
...................................................................................................................#..............#.........
#...........................................................................................................#...............................
........#.......#............................................................................................................#..............
............................#.....................#..........#......................................#.....................................#.
.....................................#.................................................#........................#...........................
.........................................................................................................................#...........#......
.......................#.............................#........................#.............................................................
..............#...............................#.................#..................#........#...............................................
...#......................................................................#.................................#..............................#
...................#..................#.............................................................................#........#..............
............................................................................................................................................
.........................#.........................#........................................................................................
......#......#.............................................#.............................#............#.....................................
.................................#......................................#...................................................................
.........................................#........................#..............................#.................#..............#.........
............................................................................................................................................
......................................................#.................................................#..............#..................#.
......................#......#...............#...................................#............................#.............................
....#...........#.................#............................................................#...............................#............
..........................................................................#..........................#......................................
..........................................#................................................#...............................#............#...
................................................................................................................#...........................
..........#....................................#...................................................................................#........
................................#....................#..............................................................#.......................
......#.......................................................#...............................#.............................................
#.......................#.....................................................................................................#.............
.................#...................#...........................................#..........................#...............................
.....................................................................#....................#.................................................
..............................#.................#.......#.........................................#.........................................
..#........................................................................#....................................#.........#.................
...........#............................#..........................................#.............................................#..........
......#.............................................................................................................#.....................#.
........................................................................................................#...................................
..............#...................#.........#...............................................................................................
........................................................#.............#..........#.....#..........#............................#............
.........#......................................................#...........................#...............................................
.........................................#...................................#.................................#............................
............................................................................................................................................
................#...................................................................#.................#..................#..................
.................................#..........................#.............#....................#................................#..........#
...#........................#.........................................................................................................#.....
.................................................#......................................#.....................#......#......................
...........................................#.........................#........#.............................................................
........#......#...................................................................................................................#.....#..
.#..................#..................................#.........#..........................................................................
..................................#.....#.................................#.................................................................
...................................................#.................................#......................................................
............................................................#...............................................................................
.............................................#......................#..........#............#.........................#......#..............
................................#...................................................................#.......................................
.....................................................#..................#......................................#............................
...#......................#.....................................................................................................#...........
...........#...........................................................................#..............................................#.....
................#..................................................#..............................................#.........................
.......................#......................................................................#.............................................
................................#........#.........#.....................#.....#......................#.....................................
.#..........................................................................................................................................
........................................................#................................#...................#..................#...........
.....................................#........#.................................................#.......................................#...
.........#...........#......................................................................................................................
....................................................#.............................................................#.................#.......
.............#............#........................................#.............#.....................#...................#...............#
..................#....................#.................................#.............#....................................................
................................................#...........................................................................................
.......................#...............................................................................................#....................
....#..........................................................#.....#..............#...........................................#...........
...............................................................................................#..................#.......................#.
.........#...................#............................................#.................................................................
.............................................................................................................#..............#......#........
...........................................................................................#................................................
.#...........................................................#..............................................................................
..............#..............................#........................................#.............#.......................................
....................................#..............#..............#.........#.............................#.............#.............#.....
....................#............................................................................................#..........................
.........................................................................................#..................................................
...........#............................#................#....................................................................#.............
.....#......................................................................................................#...............................
..................................#................................................#........#.............................................#.
.#................#......#...........................................................................#......................................
..............................................#.......................#................#............................................#.......
.........#............................#........................#..........................................#.....#......#....................
..............................................................................................#.............................................
........................................................................................................................................#...
..........................#........................#...............#................................#............................#..........
..#........................................#............#............................................................#......................
...............................#.....#........................................#.......#......................................#..............
.......................................................................................................#....................................
.....................................................#..............................................................................#.......
........#......................................#...........................#.............................................#.................#
...................#.....#......................................#.............................#.............................................
............#.........................#......................................................................#.......#.................#....
..............................#...................................................#.........................................................
............................................#.........................................................#.....................................
.......#..........................#................#.....#.............#....................................................................
..................#.........................................................#.............#.......................................#.........";

/*
$input = "
...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#.....";*/

function day1($input) {
  $input = trim($input);
  $lines = explode("\n", $input);
  $expand_row = [];
  $expand_col = [];
  $galaxies = [];
  $res = 0;
  for ($i = 0; $i < sizeof($lines); $i++) {
    $empty = TRUE;
    $dots = str_split($lines[$i]);
    for ($j = 0; $j < sizeof($dots); $j++) {
      if ($dots[$j] != ".") {
        $galaxies[] = [$i, $j];
        $empty = FALSE;
      }
    }
    if ($empty) {
      $expand_row[] = $i;
    }
  }
  for ($i = 0; $i < strlen($lines[0]); $i++) {
    $empty = TRUE;
    foreach ($galaxies as $k => $g) {
      if ($g[1] == $i) {
        $empty = FALSE;
        break;
      }
    }
    if ($empty) {
      $expand_col[] = $i;
    }
  }
  $path = [];
  for ($i = 0; $i < sizeof($galaxies); $i++) {
    for ($j = $i+1; $j < sizeof($galaxies); $j++) {
      $diff = abs($galaxies[$i][0] - $galaxies[$j][0]) + abs($galaxies[$i][1] - $galaxies[$j][1]);
      for ($k = 0; $k < sizeof($expand_row); $k++) {
        if ($galaxies[$i][0] < $galaxies[$j][0] && ($expand_row[$k] >= $galaxies[$i][0]) && ($expand_row[$k] <= $galaxies[$j][0])) {
          $diff++;
        } else if ($galaxies[$i][0] > $galaxies[$j][0] && ($expand_row[$k] <= $galaxies[$i][0]) && ($expand_row[$k] >= $galaxies[$j][0])) {
          $diff++;
        }
      }
      for ($k = 0; $k < sizeof($expand_col); $k++) {
        if ($galaxies[$i][1] < $galaxies[$j][1] && ($expand_col[$k] >= $galaxies[$i][1]) && ($expand_col[$k] <= $galaxies[$j][1])) {
          $diff++;
        } else if ($galaxies[$i][1] > $galaxies[$j][1] && ($expand_col[$k] <= $galaxies[$i][1]) && ($expand_col[$k] >= $galaxies[$j][1])) {
          $diff++;
        }
      }
      $path[] = $diff;
    }
  }
  $res = array_sum($path);

  return $res;
}

function day2($input) {
  $input = trim($input);
  $lines = explode("\n", $input);
  $expand_row = [];
  $expand_col = [];
  $galaxies = [];
  $res = 0;
  for ($i = 0; $i < sizeof($lines); $i++) {
    $empty = TRUE;
    $dots = str_split($lines[$i]);
    for ($j = 0; $j < sizeof($dots); $j++) {
      if ($dots[$j] != ".") {
        $galaxies[] = [$i, $j];
        $empty = FALSE;
      }
    }
    if ($empty) {
      $expand_row[] = $i;
    }
  }
  for ($i = 0; $i < strlen($lines[0]); $i++) {
    $empty = TRUE;
    foreach ($galaxies as $k => $g) {
      if ($g[1] == $i) {
        $empty = FALSE;
        break;
      }
    }
    if ($empty) {
      $expand_col[] = $i;
    }
  }
  $expansion = 1000000 - 1;
  $path = [];
  for ($i = 0; $i < sizeof($galaxies); $i++) {
    for ($j = $i+1; $j < sizeof($galaxies); $j++) {
      $diff = abs($galaxies[$i][0] - $galaxies[$j][0]) + abs($galaxies[$i][1] - $galaxies[$j][1]);
      for ($k = 0; $k < sizeof($expand_row); $k++) {
        if ($galaxies[$i][0] < $galaxies[$j][0] && ($expand_row[$k] >= $galaxies[$i][0]) && ($expand_row[$k] <= $galaxies[$j][0])) {
          $diff += $expansion;
        } else if ($galaxies[$i][0] > $galaxies[$j][0] && ($expand_row[$k] <= $galaxies[$i][0]) && ($expand_row[$k] >= $galaxies[$j][0])) {
          $diff += $expansion;
        }
      }
      for ($k = 0; $k < sizeof($expand_col); $k++) {
        if ($galaxies[$i][1] < $galaxies[$j][1] && ($expand_col[$k] >= $galaxies[$i][1]) && ($expand_col[$k] <= $galaxies[$j][1])) {
          $diff += $expansion;
        } else if ($galaxies[$i][1] > $galaxies[$j][1] && ($expand_col[$k] <= $galaxies[$i][1]) && ($expand_col[$k] >= $galaxies[$j][1])) {
          $diff += $expansion;
        }
      }
      $path[] = $diff;
    }
  }
  $res = array_sum($path);

  return $res;
}

//echo day1($input);
echo day2($input);
